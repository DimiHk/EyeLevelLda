{% schema %}
{
  "name": "Multi Card Swiper",
  "settings": [
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Image 1"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Image 2"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Image 3"
    },
    {
      "type": "image_picker",
      "id": "image_4",
      "label": "Image 4"
    },
    {
      "type": "image_picker",
      "id": "image_5",
      "label": "Image 5"
    }
  ],
  "presets": [
    {
      "name": "Multi Card Swiper"
    }
  ]
}
{% endschema %}

<div class="swiper marquee-slider">
  <div class="swiper-wrapper">
    {% assign images = '' %}
    {% for i in (1..5) %}
      {% assign image_key = 'image_' | append: i %}
      {% assign img = section.settings[image_key] %}
      {% if img %}
        {% assign images = images | append: img | append: '||' %}
      {% endif %}
    {% endfor %}

    {% assign image_array = images | split: '||' | compact %}

    {%- comment -%}
      Duplicate images to enable seamless looping.
    {%- endcomment -%}
    {% for image in image_array %}
      {% if image %}
        <div class="swiper-slide">
          <div class="card-slide">
            <img src="{{ image | img_url: '600x600' }}" alt="Marquee image {{ forloop.index }}">
          </div>
        </div>
      {% endif %}
    {% endfor %}
    {% for image in image_array %}
      {% if image %}
        <div class="swiper-slide">
          <div class="card-slide">
            <img src="{{ image | img_url: '600x600' }}" alt="Marquee image duplicate {{ forloop.index }}">
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>

<style>
  .marquee-slider {
    width: 100%;
    height: 200px;
    overflow: hidden;
  }

  .marquee-slider .swiper-slide {
    width: auto !important;
    flex-shrink: 0;
  }

  .marquee-slider .card-slide {
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    width: 200px;
    height: 200px;
  }

  .marquee-slider .card-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (typeof Swiper !== 'undefined') {
      new Swiper('.marquee-slider', {
        slidesPerView: 'auto',
        spaceBetween: 0,
        loop: true,
        speed: 4000,
        autoplay: {
          delay: 0,
          disableOnInteraction: false,
        },
        freeMode: true,
        freeModeMomentum: false,
      });
    } else {
      console.warn('Swiper library is not loaded.');
    }
  });
</script>
